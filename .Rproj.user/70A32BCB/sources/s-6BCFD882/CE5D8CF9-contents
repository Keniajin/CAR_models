#' launch_transprot
#' 
#' This is Function is to launch the shiny application
#' @param directory  It launches the main shiny application for the package
#' @return launches the app
#' @export
#' @examples
#' launch_transprot()


launch_transprot <- function() {
  appDir <- system.file("shiny-examples", "transprot","proteomics_kwtrp.Rmd", package = "transprot")
  if (appDir == "") {
    stop("Could not find example directory. Try re-installing `transprot`.", call. = FALSE)
  }
  
  rmarkdown::run(file = appDir)
}

#' launch_select
#' 
#' This is Function is to launch mutiple shiny applications for transprot
#' @param theApp accepts one of the folders containing the shiny appplication 
#' @return launches the app you select
#' @export
#' @examples
#' launch_select()

launch_select <- function(theApp) {
  # locate all the shiny app examples that exist
  validExamples <- list.files(system.file("shiny-examples", package = "transprot"))
  
  validExamplesMsg <-
    paste0(
      "The available apps in `transprot` are: '",
      paste(validExamples, collapse = "', '"),
      "'")
  
  # if an invalid folder is given, throw an error
  if (missing(theApp) || !nzchar(theApp) ||
      !theApp %in% validExamples) {
    stop(
      'Please run `launch_select()` with a valid example app as an argument.\n',
      validExamplesMsg,
      call. = FALSE)
  }
  
  # find and launch the app
  appDir <- system.file("shiny-examples", theApp,package = "transprot")
  rmarkdown::run(file=paste0(appDir,"/","index.Rmd" ))
}
